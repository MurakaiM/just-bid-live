"use strict";function Cart(t){var n=this,a={},i=$("#shoppingCart"),e=$("#shoppingOverall"),s=t.find(".label"),o=i.find(".content"),r=i.find(".submit"),c=i.find(".empty");return this.show=function(){n.loadUidData(n.getFromCart()),i.modal("show")},this.close=function(){return i.modal("hide")},this.loadJsonData=function(t){c.addClass("none"),r.removeClass("disabled"),Object.keys(t).forEach(function(n,i){var e=new Product(t[n]);a[n]=e,o.append(e.getDom())}),n.forceChanges()},this.loadUidData=function(t){o.addClass("loading"),r.addClass("loading");var n=[];Object.keys(t).forEach(function(a){return n.push(t[a].id)}),POST("/user/orders/cart",{cart:n}).then(function(t){console.log(t),loadJsonData(t.data),o.removeClass("loading"),r.removeClass("loading")}).catch(function(t){console.log(t),o.removeClass("loading"),r.addClass("disabled")})},this.forceChanges=function(){var t=0;Object.keys(a).forEach(function(n,i){return t+=parseFloat(a[n].getTotal())}),e.text(t.toFixed(2)),i.modal("refresh"),0==Object.keys(a).length&&(c.removeClass("none"),r.addClass("disabled"))},this.removeById=function(t){delete a[t],n.forceChanges()},this.saveToCart=function(t){var a;void 0===(a=null===localStorage.getItem("cart")?{}:JSON.parse(localStorage.getItem("cart")))[t.id]?a[t.id]=t:a[t.id].quantity=parseInt(a[t.id].quantity)+parseInt(t.quantity),localStorage.setItem("cart",JSON.stringify(a)),s.transition("jiggle"),n.setNumber(Object.keys(a).length)},this.getFromCart=function(){return null===localStorage.getItem("cart")?[]:JSON.parse(localStorage.getItem("cart"))},this.setNumber=function(t){t<=0?s.addClass("hidden"):s.removeClass("hidden"),s.text(t)},this}function Product(t){function n(t){s.quantity=t<1?1:t>99?99:parseInt(t),r.val(s.quantity),i=parseFloat(s.quantity*s.cost).toFixed(2),e=parseFloat(s.quantity*s.cost+s.shipment).toFixed(2),c.text(i),d.text(e),cart.forceChanges()}var a,i,e,s=t,o=function(t){i=parseFloat(s.quantity*s.cost).toFixed(2),e=parseFloat(s.quantity*s.cost+s.shipment).toFixed(2);var n='<div class="cart_item">\n      <div class="image">\n        <img src="'+t.img_url+'" alt="">\n       </div>\n      <div class="data">\n        <div class="title">'+t.title+'</div>\n        <div class="type">'+t.type+'</div>\n        <div class="seller">Seller :\n          <a href="'+t.sellerLink+'"> '+t.sellerName+' </a>\n         </div>\n       </div>\n      <div class="quantity">\n        <i class="minus icon"></i>\n        <div class="ui input">\n          <input type="number" value="'+s.quantity+'" min="1" max="99">\n         </div>\n        <i class="plus icon"></i>\n       </div>\n      <div class="price">\n        <div class="cost">\n          <i class="fa fa-usd" aria-hidden="true"></i>\n          <span class="costSpan"> '+i+' </span>\n         </div>\n        <div class="ship"> <i class="shipping icon"></i> Shipping :\n            <span>\n              +\n              <i class="fa fa-usd" aria-hidden="true"></i>\n              <span> '+t.shipment+' </span>\n            </span>\n        </div>\n       </div>\n      <div class="ui fitted divider"></div>\n      <div class="total">\n          <i class="fa fa-usd" aria-hidden="true"></i> <span class="totalSpan"> '+e+' </span>\n       </div>\n      <div class="item_remove"> <i class="remove icon"> </i> </div>\n     </div>';return $(n)}(t),r=o.find("input"),c=o.find(".costSpan"),d=o.find(".totalSpan"),l=o.find(".minus"),u=o.find(".plus"),v=o.find(".item_remove");u.click(function(){return n(s.quantity+1)}),l.click(function(){return n(s.quantity-1)}),v.click(function(){return o.remove(),cart.removeById(s.id),void cart.forceChanges()}),r.on("change keyup paste",function(){var t=parseInt(r.val());clearTimeout(a),a=setTimeout(function(){n(Number.isInteger(t)?t<1?1:t>99?99:t:s.quantity)},300)}),this.getTotal=function(){return e},this.getDom=function(){return o}}$(function(){var t=$("#mainCart");window.WCart=new Cart(t),t.click(function(t){return WCart.show()})});