"use strict";function onLoad(){$("thead th[data-content]").popup({position:"top center"}),SetUpWinnings(),SetUpPersonal(),SetUpProducts(),SetUpDisabled(),SetUpPayouts(),SetUpAuction(),SetUpHome(),tabs=new Tabs({headers:".tabs.head",contents:".tabs.body"},{winnings:{onOpen:function(e,t){return tableWinnings.loadInSegment("/seller/winning/all",e,t)},onClose:function(){return tableWinnings.forceDelete}},products:{onOpen:function(e,t){return table.loadInSegment("/seller/product/all",e,t)},onClose:function(){return table.forceDelete()}},disabled:{onOpen:function(e,t){return tableDisabled.loadInSegment("/seller/product/disabled",e,t)},onClose:function(){return tableDisabled.forceDelete()}},auctions:{onOpen:function(e,t){return tableAuctions.loadInSegment("/seller/auction/all",e,t)},onClose:function(){return tableAuctions.forceDelete()}},home:{onOpen:function(e,t){dataStats.load(e,t)},onClose:function(){dataStats.image.attr("src","")}},payouts:{onOpen:function(e,t){payoutsStats.load(e,t)},onClose:function(){}},personal:{onOpen:function(e,t){return personalStats.load(e,t)},onClose:function(){}}}),$("#signout").click(function(e){return POST("/user/signout")})}function reworkRating(e){for(var t=parseInt(e||0),a='<div class="ui star rating rated" >',n=1;n<=5;n++)a+=n<=t?'<i class="icon active"></i>':'<i class="icon"></i>';return a+"</div>"}function reworkStock(e,t){return!0===t?'\n    <td class="stock negative">\n      <i class="attention icon"></i>\n      '+e+"\n    </td>":'<td class="stock">'+e+"</td>"}function reworkBoolean(e){return'<td style="text-align:center;"> <i class="'+(e?"checkmark green":"remove red")+' icon"></i> </td>'}function SetUpPayouts(){function e(e,t){var a=$('<div class="row no-margin" data-id="'+e.itemId+'">\n                        <div class="three wide column flex center"> \n                          <button class="ui compact button">Details</button> \n                        </div>\n                        <div class="two wide column flex center">\n                          <span class="currency"> $'+toCurrency((e.amount?e.amount:0)/100)+' </span>\n                        </div>\n                        <div class="two wide column flex center">\n                          <span class="currency">$'+toCurrency((e.fee?e.fee:0)/100)+' </span>\n                        </div>\n                        <div class="four wide column flex center">\n                          <span class="inline-link"> '+e.type+' </span>\n                        </div>     \n                        <div class="five wide column flex center"> \n                          <span class="inline-link"> '+new Date(e.createdAt).toLocaleString()+" </span>\n                        </div>                                        \n                      </div>"),n=a.data("id");return a.find("button").click(function(e){winningItem=n,winningsDetails.toggleState()}),a}var t=$("#payouts");payoutsStats={load:function(t,a){LoadSegment("/seller/store/payouts",t,a).then(function(t){return function(t,a){var n={amount:0,fee:0},i={amount:0,fee:0},r=t.result.requested.payout;1==t.result.requested.requested?payoutsStats.requested.html("<b>$"+toCurrency(r.amount/100)+"</b> was requested at <b>"+new Date(r.createdAt).toLocaleDateString()+"</b>. \n               Current status - <b>"+r.status+"</b>.\n               You can't request new payout until this request is not finished.\n              "):payoutsStats.requested.html("no earnings were requested for now."),payoutsStats.paidAvailable=!t.result.requested.requested,payoutsStats.pendingList.empty(),payoutsStats.availableList.empty(),payoutsStats.requestedList.empty(),t.result.pending.forEach(function(t){n.amount+=t.amount?t.amount:0,n.fee+=t.fee?t.fee:0,payoutsStats.pendingList.append(e(t))}),t.result.available.forEach(function(t){t.amount-=t.fee,i.amount+=t.amount?t.amount:0,i.fee+=t.fee?t.fee:0,payoutsStats.availableList.append(e(t))}),t.result.listed.forEach(function(t){return payoutsStats.requestedList.append(e(t))}),0==t.result.pending.length&&payoutsStats.pendingList.append('<div class="paidempty"> No records to show </div>'),0==t.result.available.length&&payoutsStats.availableList.append('<div class="paidempty"> No records to show </div>'),0==t.result.listed.length&&payoutsStats.requestedList.append('<div class="paidempty"> No records to show </div>'),payoutsStats.pending.text("$"+toCurrency(n.amount/100)),payoutsStats.available.text("$"+toCurrency(i.amount/100)),payoutsStats.reqSummary.text("$"+toCurrency(r?r.amount/100:0)),a.removeClass("loading")}(t.result.data,a)}).catch()},requested:t.find("#requested"),pending:t.find('.big.itemed[data-tab="pending"] .money'),available:t.find('.big.itemed[data-tab="available"] .money'),reqSummary:t.find('.big.itemed[data-tab="requested"] .money'),pendingList:t.find('.tab.segment[data-tab="pending"] .grid.wr'),requestedList:t.find('.tab.segment[data-tab="requested"] .grid.wr'),availableList:t.find('.tab.segment[data-tab="available"] .grid.wr'),paidAvailable:!1},$(".menu .itemed").tab({onVisible:function(e){return"available"==e&&payoutsStats.paidAvailable?$("#getpaid").removeClass("disabled"):$("#getpaid").addClass("disabled")}})}function SetUpHome(){var e=$("#home");dataStats={load:function(e,t){LoadSegment("/seller/store/statistics",e,t).then(function(e){return function(e,t){dataStats.title.text(e.seller.title),dataStats.description.text(e.seller.description),dataStats.subtitle.text(e.seller.subtitle),dataStats.solds.text(e.allSolds?e.allSolds:0),dataStats.views.text(e.allViews?e.allViews:0),dataStats.orders.text(e.allOrders?e.allOrders:0),dataStats.products.text(e.allProducts?e.allProducts:0),e.seller.cover&&(dataStats.image.addClass("avatar"),dataStats.image.attr("src",e.seller.cover)),t.removeClass("loading")}(e.result.data,t)}).catch()},wrapper:e,image:e.find("img"),title:e.find(".title"),subtitle:e.find(".subtitle"),description:e.find(".description"),solds:e.find(".allSolds"),views:e.find(".allViews"),orders:e.find(".allOrders"),products:e.find(".allProducts")}}function SetUpPersonal(){function e(){personalStats.informationButton.removeClass("loading"),personalStats.informationTitle.removeClass("disabled"),personalStats.informationSubtitle.removeClass("disabled"),personalStats.informationDescription.removeClass("disabled")}function t(){personalStats.avatarButton.removeClass("loading"),personalStats.avatarSelectable.removeClass("disabled")}function a(){personalStats.paypalButton.removeClass("loading"),personalStats.paypalInput.removeClass("disabled")}var n=$("#personal");(personalStats={data:null,load:function(e,t){LoadSegment("/seller/store/personal",e,t).then(function(e){return function(e,t){personalStats.data=e,e.paypalEmail&&(personalStats.paypalInput.val(e.paypalEmail),(new Date).getTime()<new Date(e.paypalAccepted).getTime()?(personalStats.paypalAvaiting.removeClass("hidden"),$("#paypal_date").text(new Date(e.paypalAccepted).toLocaleDateString())):personalStats.paypalSuccess.removeClass("hidden")),e.cover&&(personalStats.avatarImg.addClass("avatar"),personalStats.avatarImg.attr("src",e.cover)),personalStats.informationTitle.val(e.title),personalStats.informationSubtitle.val(e.subtitle),personalStats.informationDescription.val(e.description),t.removeClass("loading")}(e.result.data,t)}).catch()},wrapper:n,paypalForm:n.find("#paypal_update"),paypalButton:n.find("#paypal_update button"),paypalInput:n.find("#paypal_update input"),paypalAvaiting:n.find("#paypal_update .ui.message.yellow"),paypalSuccess:n.find("#paypal_update .ui.message.green"),paypalError:n.find("#paypal_update .ui.message.red"),avatarForm:n.find("#avatar_update"),avatarSelectable:n.find("#avatar_update label.ui.button.submit"),avatarButton:n.find("#avatar_update button"),avatarImg:n.find("#avatar_update img"),avatarInput:n.find("#new_avatar"),avatarSuccess:n.find("#avatar_update .ui.green"),avatarError:n.find("#avatar_update .ui.red"),informationForm:n.find("#info_update"),informationTitle:n.find('#info_update input[name="title"]'),informationSubtitle:n.find('#info_update input[name="subtitle"]'),informationDescription:n.find('#info_update textarea[name="description"]'),informationButton:n.find("#info_update button"),informationSuccess:n.find("#info_update .ui.message.green"),informationError:n.find("#info_update .ui.message.red")}).paypalForm.submit(function(e){return e.preventDefault(),!1}),personalStats.paypalForm.form({inline:!0,fields:{paypalEmail:{rules:[{type:"email",prompt:"Please enter email in valid format"}]}}}),personalStats.paypalButton.click(function(e){personalStats.paypalForm.form("is valid")&&personalStats.paypalInput.val()!=personalStats.data.paypalEmail&&(personalStats.paypalButton.addClass("loading"),personalStats.paypalInput.addClass("disabled"),POST("/seller/payout/paypal/update",{email:personalStats.paypalInput.val()}).then(function(e){a();var t=new Date;t.setDate(t.getDate()+3),personalStats.paypalSuccess.addClass("hidden"),personalStats.paypalAvaiting.removeClass("hidden"),$("#paypal_date").text(t.toLocaleDateString())}).catch(function(e){return a()}))}),personalStats.avatarForm.submit(function(e){return e.preventDefault(),!1}),personalStats.avatarButton.click(function(e){personalStats.avatarButton.addClass("loading"),personalStats.avatarSelectable.addClass("disabled"),FormPOST("/seller/avatar/update",new FormData(personalStats.avatarForm[0])).then(function(e){t(),personalStats.avatarSuccess.removeClass("hidden"),setTimeout(function(e){return personalStats.avatarSuccess.addClass("hidden")},5e3)}).catch(function(e){t(),personalStats.avatarError.removeClass("hidden"),setTimeout(function(e){return personalStats.avatarError.addClass("hidden")},5e3)})}),personalStats.informationForm.submit(function(e){return e.preventDefault(),!1}),personalStats.informationForm.form({fields:{title:{rules:[{type:"empty",prompt:"Please enter store title"}]},subtitle:{rules:[{type:"empty",prompt:"Please enter store subtitle"}]},description:{rules:[{type:"empty",prompt:"Please enter store description"},{type:"maxLength[255]",prompt:"Description is too long"}]}}}),personalStats.informationButton.click(function(t){personalStats.informationForm.form("is valid")&&(personalStats.informationButton.addClass("loading"),personalStats.informationTitle.addClass("disabled"),personalStats.informationSubtitle.addClass("disabled"),personalStats.informationDescription.addClass("disabled"),POST("/seller/information/update",{title:personalStats.informationTitle.val(),subtitle:personalStats.informationSubtitle.val(),description:personalStats.informationDescription.val()}).then(function(t){e(),personalStats.informationSuccess.removeClass("hidden"),setTimeout(function(e){return personalStats.informationSuccess.addClass("hidden")},5e3)}).catch(function(t){e(),personalStats.informationError.removeClass("hidden"),setTimeout(function(e){return personalStats.informationError.addClass("hidden")},5e3)}))}),personalStats.avatarInput.on("change",function(e){return readURL(personalStats.avatarInput,personalStats.avatarImg)})}function SetUpProducts(){function e(e,t,a){if(a&&0!=Object.keys(a).length){var n=$("<div class='ui grid'></div>");return Object.keys(a).forEach(function(i){return n.append(new function(e,t,a){var n=this;return this.isDisabled=1==a.disable,this.generateButton=function(e){var t={};return 1==e?(t.classes="ui button tiny green",t.title="Enable"):(t.classes="ui button tiny red",t.title="Disable"),'<button type="button" class="'+t.classes+'"> '+t.title+" </button>"},this.switchButton=function(e){e.toggleClass("loading"),n.isDisabled?(e.removeClass("red"),e.addClass("green"),e.text("Enable")):(e.removeClass("green"),e.addClass("red"),e.text("Disable"))},this.row=$('<div class="three column row wrap">\n      <div class="column flexfull center">'+a.title+'</div>\n      <div class="column"> <input type="text" class="partlydisabled" value="'+a.value+'"/></div>\n      <div class="column flexfull center"> '+this.generateButton(this.isDisabled)+" </div>\n    </div>"),this.button=this.row.find("button"),this.button.click(function(i){n.button.addClass("loading"),n.isDisabled=!n.isDisabled,POST("/seller/product/typesout",{uid:t,available:n.isDisabled,name:a.value,group:e}).then(function(e){return n.switchButton(n.button)})}),this.template=function(){return n.row},this}(t,e,a[i]).template())}),n.append('<div class="ui divider fitted"></div>'),n}}$(".ui.small.icon.button").popup({position:"bottom center"});var t=null,a=null,n={open:$("#productsOpen"),delete:$("#productsDelete"),create:$("#productsCreate"),auction:$("#productAuction"),edit:$("#productsEdit"),change:$("#productsChange"),refresh:$("#productsRefresh")};Simditor.locale="en-US",toolbar=["title","bold","italic","underline","strikethrough","fontScale","color","|","ol","ul","blockquote","table","|","link","image","hr","|","indent","outdent","alignment"],table=new Table("products",{defaultSort:"updatedAt",search:"#productsSearch",forPage:"#productsDrop",buttons:{previous:".left.icon.item",next:".right.icon.item",to:".ui.button.radiusless.borderless"},input:{to:".ui.left.action input"},row:function(e){var t=!1;return e.types.forEach(function(e){return e.inStock<=0&&(t=!0)}),$("\n        <tr>\n          <td>"+e.prTitle+"</td>\n          "+reworkStock(e.prStock,t)+'\n          <td><i class="dollar icon"></i>'+toCurrency(e.prCost)+"</td>          \n          "+reworkBoolean(e.auctions.length>0)+"\n          <td>"+e.prViews+"</td>\n          <td>"+e.prSold+"</td>       \n          <td>"+new Date(e.updatedAt).toLocaleDateString()+"</td>\n          <td>"+new Date(e.createdAt).toLocaleDateString()+"</td>         \n        </tr>\n      ")},click:function(e,i,r){n.auction.removeClass("disabled"),n.delete.removeClass("disabled"),n.edit.removeClass("disabled"),n.open.removeClass("disabled"),n.change.removeClass("disabled"),t={i:e,obj:i,arr:r},a={i:e}},onFocusLost:function(){n.auction.addClass("disabled"),n.delete.addClass("disabled"),n.edit.addClass("disabled"),n.open.addClass("disabled"),n.change.addClass("disabled"),t=null}});var i=new NestedList("#typesColorist",{listplace:".ui.grid",submiter:".teal",isFiled:{inputName:"image",pathName:"path",buttonName:"imagebutton"},inputs:[{as:"title",name:"titleVR",valid:function(e){return 0!=e.length}},{as:"value",name:"valueVR",valid:function(e){return 0!=e.length}},{name:"path",valid:function(e){return e.length>0}},{name:"color",valid:function(e){return!0}},{name:"image",valid:function(e){return 0!=e.length}}],mockuper:function(e,t){var a=e.image?'<img src="'+e.uri+'" />':" - ",n=$('   \n          <div class="row">   \n            <div class="four wide column">'+e.title+'</div>\n            <div class="four wide column">'+e.value+'</div>          \n            <div class="two wide column"><a class="ui circular empty label" style="background : '+e.color+'; "></a> </div>\n            <div class="four wide column">'+a+'</div>\n            <div class="two wide column">\n              <button class="ui icon button red small"> <i class="trash outline icon"></i> </button>\n            </div>  \n          </div>      \n        ');return n.find("button").click(function(e){n.remove(),i.forceDelete(t)}),$(n)},maxSize:10}),r=new NestedList("#typesSize",{listplace:".ui.grid",submiter:".teal",inputs:[{as:"title",name:"titleVR",valid:function(e){return 0!=e.length}},{as:"value",name:"valueVR",valid:function(e){return 0!=e.length}}],mockuper:function(e,t){var a=$('   \n        <div class="row">   \n          <div class="seven wide column">'+e.title+'</div>\n          <div class="seven wide column">'+e.value+'</div>  \n          <div class="two wide column">\n            <button class="ui icon button red small"> <i class="trash outline icon"></i> </button>\n          </div>  \n        </div>      \n      ');return a.find("button").click(function(e){a.remove(),r.forceDelete(t)}),$(a)}}),s=new NestedCreator(i,r,"#typesStock"),o=new Simditor({textarea:$("#createModal .wwc"),toolbar:toolbar,defaultImage:"../<%=resources%>/g.assets/img/usericons/image.png"}),l=new Modal({id:"#deleteModal",onOpen:function(e){return e.find(".exact").text(t.arr[t.i].prTitle)},onClose:function(e){e.find("input").val(""),e.find("button").addClass("disabled")},middleware:function(e){e.find("form");var a=e.find("input"),n=e.find("button");n.addClass("disabled"),a.on("change keyup paste",function(e){e.target.value==t.arr[t.i].prTitle?n.removeClass("disabled"):n.addClass("disabled")}),n.click(function(e){n.addClass("loading"),POST("/seller/product/delete",{uid:t.arr[t.i].prUid}).then(function(e){t.arr.splice(t.i,1),l.toggleState(),n.removeClass("loading"),table.redraw()}).catch(function(e){l.toggleState(),n.removeClass("loading")})})}},!0),d=new Modal({id:"#createModal",closer:".closer",closable:!0,overflowed:!0,onOpen:function(e){e.find("form").form("clear"),i.forceEmpty(),o.setValue(""),s.forceEmpty(),r.forceEmpty(),i.forceEmpty()},onClose:function(e){},middleware:function(e,t,a){return function(e,t,a,n,i,r){$(t.find(".ui.search.cat")).search({type:"category",minCharacters:2,apiSettings:{onResponse:function(e){return e.results={},e.data.forEach(function(t,a){var n=t.category||"Unknown";if(a>=8)return!1;void 0===e.results[n]&&(e.results[n]={name:n,results:[]}),e.results[n].results.push({title:t.name})}),e},url:"/seller/categories/search={query}"}});var o={on:"blur",inline:!0,rules:{title:{identifier:"title",rules:[{type:"empty",prompt:"Please enter product title"}]},cost:{identifier:"cost",rules:[{type:"currency",prompt:"Please enter valid cost in format XX.XX"}]},shipment:{identifier:"shipment",rules:[{type:"shipment",prompt:"Please enter valid cost in format XX.XX (0$ - 30$)"}]},delivery:{identifier:"delivery",rules:[{type:"integer[1..180]",prompt:"Please enter valid delivery time (days)"}]},category:{identifier:"category",rules:[{type:"empty",prompt:"Please search for categories and select"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter product description"},{type:"minLength[20]",prompt:"Minimum 20 symbols"},{type:"maxLength[250]",prompt:"Maximum 250 symbols"}]},stock:{identifier:"material",rules:[{type:"empty",prompt:"Please enter material title of product"}]},guarantee:{identifier:"guarantee",rules:[{type:"integer[1..72]",prompt:"Please enter guarantee (Months)"}]}},success:function(t){r.forceRow(t),a.forceEmpty(),i.setValue(""),e.toggleState()},dataMiddleware:function(e){return Object.keys(a.getData()).forEach(function(e){return delete a.getData()[e].uri}),Object.keys(a.getData()).forEach(function(t){return e.append("filefor"+t,a.getData()[t].image)}),e.append("colors",JSON.stringify(a.getData())),e.append("sizes",JSON.stringify(n.getData())),e.append("full",i.getValue()),e}},l=new Form(t.find("form"),"/seller/product/create",o,!0);s.setForm(l)}(a,e,i,r,o,table)}},!1),u=new Modal({id:"#changeModal",closer:".closer",closable:!0,overflowed:!0,onOpen:function(e,a){a.exact.text(t.arr[t.i].prTitle),a.description.val(t.arr[t.i].prDescription),a.full.setValue(t.arr[t.i].prFull)},onClose:function(e){},middleware:function(e,a,n){a.exact=e.find(".exact"),a.description=e.find('textarea[name="description"]'),a.full=new Simditor({textarea:$("#changeModal .wwc"),toolbar:toolbar,defaultImage:"../<%=resources%>/g.assets/img/usericons/image.png"}),a.form=new Form(e.find("form"),"/seller/product/change",{inline:!0,on:"blur",rules:{delivery:{identifier:"delivery",rules:[{type:"integer[1..180]",prompt:"Please enter valid delivery time (days)"}]}},dataMiddleware:function(e){return e.id=t.arr[t.i].prUid,e.full=a.full.getValue(),e},success:function(e){return setTimeout(function(e){return n.toggleState()},3e3)},failure:function(e,t){}})}},!1),c=new Modal({id:"#editModal",reset:!0,overflowed:!0,closer:".closer",onOpen:function(n,i){var r=t.arr[t.i].prUid;i.input.val(t.arr[t.i].prStock),i.name.text(t.arr[t.i].prTitle),i.types.addClass("loading"),i.types.empty(),i.stock.addClass("loading"),i.stock.empty(),POST("/seller/product/types",{id:r}).then(function(t){return function(t,a,n){t.empty(),t.append(e(a,"colors",n.prTypes.colors)),t.append(e(a,"sizes",n.prTypes.sizes)),t.removeClass("loading")}(i.types,r,t.data)}),POST("/seller/product/stocks",{id:r}).then(function(e){return function(e,t,n){e.empty(),e.append(function(e,n){if(n&&0!=Object.keys(n).length){var i=$("<div class='ui grid'></div>");return Object.keys(n).forEach(function(e){return i.append(new function(e,t){var n=this;return this.row=$('    \n        <div class="row wrap"> \n          <form class="column ui form">\n              <div class="three fields">        \n                <div class="field flexfull center">'+t.title+'</div>\n                <div class="field"> <input type="text" name="stock" value="'+t.inStock+'"/> </div>\n                <div class="field flexfull center"> <button type="submit" class="ui button tiny submit" > Update </button> </div>  \n              </div> \n              <div class="ui message success">\n                  <div class="header">Action Completed</div>\n                  <p> Product\'s type stock was updated </p>\n              </div>\n              <div class="ui custom message error">\n                <div class="header">Action Forbidden</div>\n                <p></p>\n              </div>\n          </form>  \n        </div>\n      '),this.form=new Form(this.row.find("form"),"/seller/product/stock",{on:"blur",inline:!0,delay:250,justbutton:!0,rules:{stock:{identifier:"stock",rules:[{type:"integer[1..99999]",prompt:"Please enter valid stock value(1 - 99999)"}]}},dataMiddleware:function(a){return a.productId=e,a.typeId=t.typeId,a},success:function(e,t){table.forceChange(a.i,e),setTimeout(function(e){return t.removeClass("success")},3e3)},failure:function(e,t){return setTimeout(function(e){return t.removeClass("error")},3e3)}}),this.template=function(){return n.row},this}(t,n[e]).template())}),i.append('<div class="ui divider fitted"></div>'),i}}(0,n)),e.removeClass("loading")}(i.stock,r,e.data)})},onClose:function(e,t){},middleware:function(e,t,a){t.input=e.find("form").find("input"),t.types=e.find(".ui.segment.types"),t.stock=e.find(".ui.segment.stock"),t.name=e.find(".exact")}},!0),p=new Modal({id:"#auctionNewModal",reset:!0,overflowed:!0,onOpen:function(e,a){a.form.removeClass("success error"),a.form.form("reset"),a.dropdown.dropdown("clear"),a.fee.val("Fee"),a.exp.val("Explanation"),a.ape.val("Appearence"),a.str.val("Starting price"),a.exact.text(t.arr[t.i].prTitle)},onClose:function(e,t){},middleware:function(e,a,n){var i={inline:!0,on:"blur",rules:{stock:{identifier:"stock",rules:[{type:"integer[1..99999]",prompt:"Stock should be positive number (1 - 99999)"}]},type:{identifier:"type",rules:[{type:"empty",prompt:"Select type of auction item"}]},str:{identifier:"str",rules:[{type:"currency",prompt:"Select valid auction starting price"}]}},dataMiddleware:function(e){return e.uidProduct=t.arr[t.i].prUid,e},success:function(e){},failure:function(e,t){}};a.form=e.find("form"),a.submit=a.form.find("button"),a.exact=e.find(".exact"),a.fee=e.find('input[name="fee"]'),a.exp=e.find('input[name="exp"]'),a.ape=e.find('input[name="ape"]'),a.str=e.find('input[name="str"]'),a.dropdown=e.find(".ui.dropdown").dropdown({onChange:function(e,t,n){currentFees[e]&&(a.fee.val("dollar"==currentFees[e].type?"$"+String(currentFees[e].fee):String(currentFees[e].fee)+"%"),a.ape.val(currentFees[e].appearance),a.exp.val(currentFees[e].explanation),"reserved"==e?(a.str.parent().removeClass("partlydisabled"),a.str.val("")):(a.str.parent().addClass("partlydisabled"),a.str.val(currentFees[e].begin)),a.form.form("validate field","str"))}}),a.preparedForm=new Form(a.form,"/seller/auction/create",i)}},!1);n.delete.click(function(e){return l.toggleState()}),n.create.click(function(e){return d.toggleState()}),n.auction.click(function(e){return p.toggleState()}),n.change.click(function(e){return u.toggleState()}),n.edit.click(function(e){return c.toggleState()}),n.open.click(function(e){return window.open("/product/id"+t.arr[t.i].prUid)}),n.refresh.click(function(e){return table.loadFromCache()})}function SetUpDisabled(){var e=null,t={renew:$("#disabledRenew"),delete:$("#disabledDelete"),refresh:$("#disabledRefresh")};tableDisabled=new Table("disabled",{defaultSort:"updatedAt",search:"#disabledSearch",forPage:"#disabledDrop",buttons:{previous:".left.icon.item",next:".right.icon.item",to:".ui.button.radiusless.borderless"},input:{to:".ui.left.action input"},row:function(e){return $(" \n        <tr>\n          <td>"+e.prTitle+"</td> \n          <td>"+reworkRating(e.prRating)+"</td>\n          <td>"+e.prViews+"</td>\n          <td>"+e.prSold+"</td>       \n          <td>"+new Date(e.updatedAt).toLocaleDateString()+"</td>               \n        </tr>\n      ")},click:function(a,n,i){t.renew.removeClass("disabled"),t.delete.removeClass("disabled"),e={i:a,obj:n,arr:i}},onFocusLost:function(){t.renew.addClass("disabled"),t.delete.addClass("disabled"),e=null}});var a=new Modal({id:"#renewModal",onOpen:function(t){return t.find(".exact").text(e.arr[e.i].prTitle)},onClose:function(e){e.find("input").val(""),e.find("button").addClass("disabled")},middleware:function(t){var n=t.find("input"),i=t.find("button");i.addClass("disabled"),n.on("change keyup paste",function(t){t.target.value==e.arr[e.i].prTitle?i.removeClass("disabled"):i.addClass("disabled")}),i.click(function(t){i.addClass("loading"),POST("/seller/product/renew",{uid:e.arr[e.i].prUid}).then(function(t){e.arr.splice(e.i,1),tableDisabled.redraw(),i.removeClass("loading"),a.toggleState()}).catch(function(e){a.toggleState(),i.removeClass("loading")})})}},!0),n=new Modal({id:"#finishModal",onOpen:function(t){t.find(".exact").text(e.arr[e.i].prTitle),t.find("form").removeClass("error")},onClose:function(e){e.find("input").val(""),e.find("button").addClass("disabled")},middleware:function(t){var a=t.find("input"),i=t.find("button"),r=t.find("form"),s=t.find(".error.message p");i.addClass("disabled"),a.on("change keyup paste",function(t){t.target.value==e.arr[e.i].prTitle?i.removeClass("disabled"):i.addClass("disabled")}),i.click(function(t){i.addClass("loading"),POST("/seller/product/remove",{uid:e.arr[e.i].prUid}).then(function(t){e.arr.splice(e.i,1),tableDisabled.redraw(),i.removeClass("loading"),n.toggleState()}).catch(function(e){s.text(e.reason),r.addClass("error"),i.removeClass("loading")})})}},!0);t.renew.click(function(e){return a.toggleState()}),t.delete.click(function(e){return n.toggleState()}),t.refresh.click(function(e){return tableDisabled.loadFromCache()})}function SetUpAuction(){var e=null,t={stock:$("#auctionsStock"),pause:$("#auctionsPause"),refresh:$("#auctionsRefresh")},a=new Modal({id:"#auctionUpdateModal",onOpen:function(t,a){return t.find(".exact").text(e.arr[e.i].product.prTitle)},onClose:function(e,t){return e.find("input").val("")},middleware:function(t,a,n){var i={on:"blur",inline:!0,rules:{stock:{identifier:"stock",rules:[{type:"integer[1..99999]",prompt:"Stock should be positive number (1 - 99999)"}]}},dataMiddleware:function(t){return t.uidRecord=e.arr[e.i].uidRecord,t},success:function(t){var a=e.arr[e.i];a.inStock=t,tableAuctions.forceChange(e.i,a)},failure:function(e){}};a.form=new Form(t.find("form"),"/seller/auction/stock",i)}},!0),n=new Modal({id:"#auctionPauseModal",onOpen:function(t,a){a.exact.text(e.arr[e.i].product.prTitle),a.current=e,e.arr[e.i].temporaryDisabled?(a.button.text("Unpause"),a.button.removeClass("red"),a.button.addClass("green")):(a.button.text("Pause"),a.button.removeClass("green"),a.button.addClass("red"))},onClose:function(e,t){return t.current=null},middleware:function(e,t,a){var n={rules:{button:{identifier:"title",rules:[{type:"empty"}]}},dataMiddleware:function(e){return e.uidRecord=t.current.arr[t.current.i].uidRecord,e.temporaryDisabled=!t.current.arr[t.current.i].temporaryDisabled,e},success:function(e){var a=t.current.arr[t.current.i];a.temporaryDisabled=!a.temporaryDisabled,tableAuctions.forceChange(t.current.i,a),redrawButton(t,a.temporaryDisabled)}};t.exact=e.find(".exact"),t.button=e.find("button"),t.form=new Form(e.find("form"),"/seller/auction/pause",n)}},!0);tableAuctions=new Table("auctions",{defaultSort:"updatedAt",search:"#auctionsSearch",forPage:"#auctionsDrop",buttons:{previous:".left.icon.item",next:".right.icon.item",to:".ui.button.radiusless.borderless"},input:{to:".ui.left.action input"},row:function(e){return $(" \n        <tr>\n          <td>"+e.productTitle+"</td> \n          <td>"+currentFees[e.uidFee].title+"</td>\n          <td>"+e.inStock+'</td>\n          <td><i class="dollar icon"></i>'+toCurrency(e.currentBid)+"</td>       \n          "+reworkBoolean(e.onAuction)+"\n          "+reworkBoolean(e.isCompleted)+"\n          "+reworkBoolean(e.temporaryDisabled)+"\n          <td>"+new Date(e.updatedAt).toLocaleDateString()+"</td>\n          <td>"+new Date(e.createdAt).toLocaleDateString()+"</td>   \n        </tr>\n      ")},transformation:function(e){return e.currentBid=e.currentBid/100,e.productTitle=e.product.prTitle,e},click:function(a,n,i){t.stock.removeClass("disabled"),t.pause.removeClass("disabled"),e={i:a,obj:n,arr:i}},onFocusLost:function(){t.stock.addClass("disabled"),t.pause.addClass("disabled"),e=null}}),t.refresh.click(function(e){return tableAuctions.loadFromCache()}),t.stock.click(function(e){return a.toggleState()}),t.pause.click(function(e){return n.toggleState()})}function SetUpWinnings(){var e=null,t={details:$("#winningsDatails"),update:$("#winningsUpdate"),refresh:$("#winningsRefresh")},a=new Modal({id:"#winningUpdateModal",onOpen:function(t,a){return t.find(".exact").text(e.arr[e.i].winnerName)},onClose:function(e,t){},middleware:function(t,a,n){var i={on:"blur",inline:!0,rules:{track:{identifier:"track",rules:[{type:"empty",prompt:"Type clear and proper status description"}]}},dataMiddleware:function(t){return t.record=e.arr[e.i].winningId,t},success:function(t){var a=e.arr[e.i];a.productTrack=t,a.status="Sent",tableWinnings.forceChange(e.i,a)},failure:function(e){return console.log(error)}};a.form=new Form(t.find("form"),"/seller/winning/track",i)}},!0);winningsDetails=new Modal({id:"#winningDetailsModal",onOpen:function(e,t){t.segment.addClass("loading"),POST("/seller/winning/especial",{winningId:winningItem}).then(function(e){return t.insertInto(e.data)}).catch(function(e){return console.log(e)})},onClose:function(e,t){return t.deleteInfo()},middleware:function(e,t,a){t.segment=e.find(".ui.segment"),t.dataValues=e.find(".details.value"),t.addresses=e.find(".col-md-6.nopadding.addressed"),t.insertInto=function(e){$(t.dataValues[0]).text(e.user.firstName+" "+e.user.lastName),$(t.dataValues[2]).text(e.customerInformation?"Address was selected":"No address was selected yet"),$(t.dataValues[1]).find("a").attr("href","/product/id"+e.productId),$(t.dataValues[1]).find("a").text(e.product.prTitle),$(t.dataValues[3]).text(e.type?e.type.title:"Type has not been selected yet"),$(t.dataValues[4]).text(e.productTrack),$(t.dataValues[5]).text(e.status),$(t.dataValues[6]).text("$ "+toCurrency(e.lastBid/100)),$(t.dataValues[7]).text("$ "+toCurrency(e.product.prShipment)),$(t.dataValues[8]).text(e.billingId?"Yes":"No"),e.customerInformation?(t.addresses.removeClass("closed"),$(t.dataValues[9]).text(e.customerInformation["shipping[first-name]"]),$(t.dataValues[10]).text(e.customerInformation["shipping[last-name]"]),$(t.dataValues[11]).text(e.customerInformation["shipping[address]"]),$(t.dataValues[14]).text(e.customerInformation["shipping[country]"]),$(t.dataValues[12]).text(e.customerInformation["shipping[city]"]),$(t.dataValues[13]).text(e.customerInformation["shipping[code]"]),$(t.dataValues[15]).text(e.customerInformation["shipping[phone]"])):t.addresses.addClass("closed"),t.segment.removeClass("loading")},t.deleteInfo=function(){return t.dataValues.each(function(e,t){return 1!=e?$(t).text(""):$(t).find("a").text("")})}}},!0),tableWinnings=new Table("winnings",{defaultSort:"updatedAt",search:"#winningsSearch",forPage:"#winningsDrop",buttons:{previous:".left.icon.item",next:".right.icon.item",to:".ui.button.radiusless.borderless"},input:{to:".ui.left.action input"},row:function(e){return $(" \n        <tr>\n          <td>"+e.winnerName+'</td>      \n          <td><i class="dollar icon"></i>'+toCurrency(e.lastBid)+"</td>     \n          "+reworkStatus(e.status)+" \n          <td>"+(e.productTrack?e.productTrack:"Empty")+"</td>\n          "+reworkBoolean(e.isPaid)+"\n          <td>"+new Date(e.updatedAt).toLocaleDateString()+"</td>\n          <td>"+new Date(e.createdAt).toLocaleDateString()+"</td>   \n        </tr>\n      ")},transformation:function(e){return e.winnerName=e.user.firstName+" "+e.user.lastName,e.lastBid=e.lastBid/100,e},click:function(a,n,i){t.details.removeClass("disabled"),t.update.removeClass("disabled"),winningItem=(e={i:a,obj:n,arr:i}).arr[e.i].winningId},onFocusLost:function(){e=null,t.details.addClass("disabled"),t.update.addClass("disabled")}}),t.refresh.click(function(e){return tableWinnings.loadFromCache()}),t.update.click(function(e){return a.toggleState()}),t.details.click(function(e){return winningsDetails.toggleState()})}function numberRebase(e){return e<100?e:e<1e3?parseFloat(e).toFixed(2)/1e3+"h":e<1e6?parseFloat(e).toFixed(2)/1e3+"th":void 0}function redrawButton(e,t){t?(e.button.text("Unpause"),e.button.removeClass("red"),e.button.addClass("green")):(e.button.text("Pause"),e.button.removeClass("green"),e.button.addClass("red"))}function reworkStatus(e){var t="";return"New"==e?t="pr":"Paid"==e&&(t="gr"),'\n    <td>\n      <b class="light '+t+'"> \n        '+e+" \n      </b>\n    </td>\n  "}function readURL(e,t){if(e[0].files[0]){var a=new FileReader;a.onload=function(e){t.addClass("avatar"),t.attr("src",e.target.result)},a.readAsDataURL(e[0].files[0])}}var tabs,table,tableDisabled,tableAuctions,tableWinnings,dataStats,payoutsStats,personalStats,winningsDetails,winningItem=null;$(function(e){return onLoad()});var currentFees={standard:{fee:2,begin:2,type:"dollar",title:"Standard Listing",explanation:"Bids Begin at $2 and bids goes up at $1 at a time",appearance:"No Color Border"},featured:{fee:3,begin:3,type:"dollar",title:"Featured Listing",explanation:"Bids Begin at $3 and bids goes up at $1 at a time",appearance:"Purple Color Border"},small:{fee:5,begin:1,type:"per",title:"Standard 20% Percent",explanation:"Bids Begin at $1 and bids goes up at 20% at a time",appearance:"Orange Color Border"},big:{fee:10,begin:1,type:"per",title:"Big Percentage 50%",explanation:"Bids Begin at $1 and bids goes up at 50% at a time",appearance:"Pink Color Border"},reserved:{fee:15,begin:"custom",type:"per",title:"Reserved Listing",explanation:"Bids Begin at selected price aand bids goes up at $1 at a time",appearance:"Red Color Border"}};